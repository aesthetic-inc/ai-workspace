---
description: React coding standards and patterns
globs: ["**/*.tsx", "**/*.jsx"]
---

# React Rules

## Functional Components Only

```typescript
// ❌ Bad - Class components
class UserCard extends React.Component<Props> {
  render() {
    return <div>{this.props.name}</div>;
  }
}

// ✅ Good - Functional components
interface UserCardProps {
  name: string;
  email: string;
}

export function UserCard({ name, email }: UserCardProps): React.ReactElement {
  return (
    <div className="user-card">
      <h3>{name}</h3>
      <p>{email}</p>
    </div>
  );
}
```

## Hooks Rules

### Dependencies Array
```typescript
// ❌ Bad - Missing dependencies
useEffect(() => {
  fetchUser(userId);
}, []);

// ✅ Good - All dependencies included
useEffect(() => {
  fetchUser(userId);
}, [userId, fetchUser]);
```

### Custom Hooks
```typescript
// Extract reusable logic into custom hooks
function useLocalStorage<T>(key: string, initialValue: T): [T, (value: T) => void] {
  const [storedValue, setStoredValue] = useState<T>(() => {
    const item = localStorage.getItem(key);
    return item ? JSON.parse(item) : initialValue;
  });

  const setValue = useCallback((value: T) => {
    setStoredValue(value);
    localStorage.setItem(key, JSON.stringify(value));
  }, [key]);

  return [storedValue, setValue];
}
```

### Memoization
```typescript
// Use useMemo for expensive computations
const sortedItems = useMemo(
  () => items.sort((a, b) => a.name.localeCompare(b.name)),
  [items]
);

// Use useCallback for stable function references
const handleSubmit = useCallback((data: FormData) => {
  onSubmit(data);
}, [onSubmit]);

// Use React.memo for expensive child components
const ExpensiveList = React.memo(function ExpensiveList({ items }: Props) {
  return items.map(item => <ExpensiveItem key={item.id} {...item} />);
});
```

## State Management

### Local State
```typescript
// Simple state
const [count, setCount] = useState(0);

// Complex state with reducer
const [state, dispatch] = useReducer(reducer, initialState);
```

### Shared State Patterns
```typescript
// Context for theme, auth, etc.
const ThemeContext = createContext<ThemeContextType | null>(null);

export function useTheme(): ThemeContextType {
  const context = useContext(ThemeContext);
  if (!context) {
    throw new Error('useTheme must be used within ThemeProvider');
  }
  return context;
}
```

### Server State
```typescript
// Use TanStack Query for server state
const { data, isLoading, error } = useQuery({
  queryKey: ['users', userId],
  queryFn: () => fetchUser(userId),
});
```

## Component Structure

```typescript
// 1. Imports
import React, { useState, useCallback } from 'react';
import type { User } from '@/types';

// 2. Types/Interfaces
interface Props {
  user: User;
  onUpdate: (user: User) => void;
}

// 3. Component
export function UserProfile({ user, onUpdate }: Props): React.ReactElement {
  // 3a. Hooks (state, context, custom hooks)
  const [isEditing, setIsEditing] = useState(false);

  // 3b. Derived state
  const fullName = `${user.firstName} ${user.lastName}`;

  // 3c. Callbacks
  const handleSave = useCallback(() => {
    onUpdate(user);
    setIsEditing(false);
  }, [user, onUpdate]);

  // 3d. Effects
  useEffect(() => {
    document.title = fullName;
  }, [fullName]);

  // 3e. Render
  return (
    <div className="user-profile">
      <h2>{fullName}</h2>
      {isEditing ? (
        <EditForm user={user} onSave={handleSave} />
      ) : (
        <UserDetails user={user} onEdit={() => setIsEditing(true)} />
      )}
    </div>
  );
}
```

## Event Handlers

```typescript
// Name handlers with 'handle' prefix
const handleClick = () => { /* ... */ };
const handleInputChange = (e: ChangeEvent<HTMLInputElement>) => { /* ... */ };
const handleFormSubmit = (e: FormEvent) => { /* ... */ };

// Props use 'on' prefix
interface Props {
  onClick: () => void;
  onChange: (value: string) => void;
  onSubmit: (data: FormData) => void;
}
```
